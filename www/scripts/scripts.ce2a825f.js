"use strict";function AuthentificationService(a,b,c,d,e){function f(){var a=e.get(n);a&&g(a)}function g(a){i(a),j()}function h(a){e.set(n,a),i(a),j()}function i(a){o=!0,l=a,b.defaults.headers.common.Authorization=l,p.showBar=!0}function j(){p.showBar=!0,p.menu.sidemenu=[{icon:"dashboard",state:"dashboard"},{icon:"logout",state:"logout"}],m.setView(p),m.initController()}function k(){l=void 0,o=!1,b.defaults.headers.common.Authorization=void 0,p.showBar=!1,e.remove(n)}var l,m=this,n="tokenKey",o=!1,p={showBar:!1,menu:{}},q=function(a){return c(function(c,e){b.post(d.url+"/signup",a).then(function(a){a.data.success?c(a.data.msg):e(a.data.msg)})})},r=function(a){return c(function(c,e){b.post(d.url+"/authenticate",a).then(function(a){a.data.success?(h(a.data.token),c(a.data.user)):e(a.data.msg)})})},s=function(){k(),p.showBar=!1,p.menu.sidemenu={},p.menu.moremenu={},m.setView(p)},t=function(a,b){m.setView=a,m.initController=b,f()};return{init:t,login:r,register:q,logout:s,isAuthenticated:function(){return o}}}function AppController(a,b,c,d,e,f,g,h,i,j,k){function l(){d("left").toggle()}function m(){window.history.back()}function n(a){o.selected=a,f.go(a.state)}var o=this;o.selectItem=n,o.toggleList=l,o.back=m,o.menuOptions=[],a.ready.then(function(){});var p=function(a){c.isLogged=a.showBar,a.showBar&&(o.sidemenu=a.menu.sidemenu)},q=function(){o.selected=f.current};g.init(p,q),c.$on(h.notAuthenticated,function(a){g.logout(),f.go("login")});var r;this.openMenu=function(a,b){r=b,a(b)},this.logout=function(a){g.logout(),f.go("login")}}function AuthInterceptor(a,b,c){return{responseError:function(d){return a.$broadcast({401:b.notAuthenticated}[d.status],d),c.reject(d)}}}var startApp=angular.module("powerApp",["ui.router","ngAnimate","ngAria","ngResource","ngSanitize","ngTouch","ngMaterial","LocalStorageModule","ngMdIcons","Login","Main","Dashboard"]);startApp.constant("AUTH_EVENTS",{notAuthenticated:"auth-not-authenticated"}).constant("API_ENDPOINT",{url:"http://powerhero.cloudno.de"}),startApp.factory("AuthInterceptor",["$rootScope","AUTH_EVENTS","$q",AuthInterceptor]),startApp.service("AuthService",["$rootScope","$http","$q","API_ENDPOINT","localStorageService",AuthentificationService]),startApp.controller("appCtrl",["cordova","$rootScope","$scope","$mdSidenav","$mdDialog","$state","AuthService","AUTH_EVENTS","$timeout","$mdToast","$mdBottomSheet",AppController]),startApp.config(["localStorageServiceProvider","$stateProvider","$urlRouterProvider","$mdThemingProvider","$mdDateLocaleProvider","$httpProvider",function(a,b,c,d,e,f){e.formatDate=function(a){return moment(a).format("DD-MM-YYYY")},d.theme("default").primaryPalette("indigo").accentPalette("purple"),f.interceptors.push("AuthInterceptor"),c.otherwise("/main"),b.state("main",{url:"/main",templateUrl:"views/main.html",controller:"mainCtrl",controllerAs:"vm"}).state("dashboard",{url:"/dashboard",templateUrl:"views/dashboard.html",controller:"dashCtrl",controllerAs:"vm"}).state("login",{url:"/login",templateUrl:"views/login.html",controller:"loginCtrl"})}]).run(["$rootScope","$state","AuthService","AUTH_EVENTS",function(a,b,c,d){a.$on("$stateChangeStart",function(a,d,e,f){c.isAuthenticated()||"login"!==d.name&&(a.preventDefault(),b.go("login"))})}]),angular.module("powerApp").factory("cordova",["$q",function(a){var b=a.defer(),c=!1;return this.ready=b.promise,document.addEventListener("deviceready",function(){c=!0,b.resolve({})}),setTimeout(function(){c||b.resolve({})},3e3),this}]),angular.module("Login",[]).controller("loginCtrl",["$scope","$state","AuthService",function(a,b,c){a.login={username:"",password:"",remember:!1},a.loginPost=function(){c.login(a.login).then(function(a){b.go("main")},function(a){})},a.clear=function(){a.login={remember:!1}}}]),angular.module("Main",[]).controller("mainCtrl",["$scope",function(a){a.selectedIndex=0,a.onSwipeLeft=function(b){a.selectedIndex>0&&a.selectedIndex--,alert("You swiped left!!")},a.onSwipeRight=function(b){a.selectedIndex<2&&a.selectedIndex++,alert("You swiped right!!")}}]),angular.module("Dashboard",[]).controller("dashCtrl",["$scope",function(a){}]),angular.module("powerApp").run(["$templateCache",function(a){a.put("views/dashboard.html",'<div layout="row" layout-align="center center" class="md-padding" layout-wrap> test home </div>'),a.put("views/login.html",'<md-content flex layout="row" layout-align="center center"> <md-card> <md-card-content flex> <section layout="column" layout-sm="column" layout-align="center center" layout-wrap> <md-input-container> <label>Username</label> <input ng-model="login.username"> </md-input-container> <md-input-container> <label>Password</label> <input ng-model="login.password" type="password"> </md-input-container> </section> <section layout="column" layout-sm="row" layout-align="center center" layout-wrap> <md-checkbox ng-model="login.remember">Remember me</md-checkbox> </section> <section layout="row" layout-sm="row" layout-align="center center" layout-wrap> <md-button ng-click="loginPost()" class="md-raised md-primary">Login</md-button> <md-button ng-click="clear()" class="md-raised md-primary">Clear</md-button> </section> </md-card-content> </md-card> </md-content>'),a.put("views/main.html",'<md-content> <md-tabs md-dynamic-height md-border-bottom md-swipe-left="onSwipeLeft()" md-swipe-right="onSwipeRight()" md-selected="selectedIndex"> <md-tab label="one"> <md-content class="md-padding"> <h1 class="md-display-2">Tab One</h1> <p>page1</p> <md-button ng-click="onSwipeLeft()">left</md-button> <md-button ng-click="onSwipeRight()">right</md-button> </md-content> </md-tab> <md-tab label="two"> <md-content class="md-padding"> <h1 class="md-display-2">Tab Two</h1> <p>page2</p> <md-button ng-click="onSwipeLeft()">left</md-button> <md-button ng-click="onSwipeRight()">right</md-button> </md-content> </md-tab> <md-tab label="three"> <md-content class="md-padding"> <h1 class="md-display-2">Tab Three</h1> <p>Page3</p> <md-button ng-click="onSwipeLeft()">left</md-button> <md-button ng-click="onSwipeRight()">right</md-button> </md-content> </md-tab> </md-tabs> </md-content>')}]);